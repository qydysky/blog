<!doctype html>
<html lang="zh-CN">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    

    <title>docker学习记录 | qydysky&#39;s blog</title>
    <meta property="og:title" content="docker学习记录 - qydysky&#39;s blog">
    <meta property="og:type" content="article">
        
    <meta property="article:published_time" content='2021-10-21T15:43:00&#43;08:00'>
        
        
    <meta property="article:modified_time" content='2021-10-21T15:43:00&#43;08:00'>
        
    <meta name="Keywords" content="qydysky,blog">
    <meta name="description" content="docker学习记录">
        
    <meta name="author" content="qydysky">
    <meta property="og:url" content="/post/20211021docker/">
    <link rel="shortcut icon" href='/favicon.ico'  type="image/x-icon">

    <link rel="stylesheet" href='/css/normalize.css'>
    <link rel="stylesheet" href='/css/style.css'>

    
        <link rel="stylesheet" href="/main.15dcb265081424711307094b8e6324bd.css" integrity="md5-FdyyZQgUJHETBwlLjmMkvQ==">
    

    <script type="text/javascript" src="/js/jquery/3.6.0/jquery.min.js"></script>

    
        <script src="/main.1237e059eab46d4c84e9924e8e2ec11f.js" integrity="md5-EjfgWeq0bUyE6ZJOji7BHw=="></script>
    
    
    
    
    
    
    
    
</head>


<body>
    <header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                
                    <a id="logo" href="/">
                        qydysky&#39;s blog
                    </a>
                
                <p class="description">日常记录</p>
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="current" href="/">首页</a>
                    
                    <a  href="/tags/" title="标签">标签</a>
                    
                    <a  href="/archives/" title="归档">归档</a>
                    
                    <a  href="/search/" title="查找">查找</a>
                    
                    <a  href="/about/" title="关于">关于</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>

    <div id="body">
        <div class="container">
            <div class="col-group">

                <div class="col-8" id="main">
                    
<div class="res-cons">
    <article class="post">
        <header>
            <h1 class="post-title">docker学习记录</h1>
        </header>
        <date class="post-meta meta-date">
            2021年10月21日
        </date>
        
        
        <div class="post-meta meta-tags">
            
            <ul class="clearfix">
                
                <li><a href='/tags/docker'>docker</a></li>
                
            </ul>
            
        </div>
        
        <div class="clear" style="display: none">
            <div class="toc-article">
                <div class="toc-title">文章目录</div>
            </div>
        </div>
        
        <div class="post-content">
            <h2 id="docker学习笔记">docker学习笔记</h2>
<h3 id="基础概念">基础概念</h3>
<h4 id="最初印象">最初印象</h4>
<p>docker引擎是一款开源的容器技术，使用它你可以快速构建你的应用容器，分发到你的基础设备上。</p>
<p>它让你可以将应用打包成独立的运行环境，简称为容器。由于其独立及安全，一个主机上可以运行许多容器。
容器是轻量的，并且包含了所有需要运行应用的环境，所以不需要对主机有其他的要求。从而你可以轻松的把容器进行分享。</p>
<p>docker提供了工具和平台来管理容器的生命周期。</p>
<ul>
<li>使用容器开发应用和组件</li>
<li>容器成为分发和测试应用的单元</li>
<li>一旦你准备好发布，部署容器到生产环境就如同本地部署一样</li>
</ul>
<p>docker能在相同的硬件条件下运行比虚拟机更多的工作载荷</p>
<h4 id="docker组织组成">docker组织组成</h4>
<ul>
<li>
<p>client:</p>
<p>创建、拉取、运行、推送docker镜像</p>
</li>
<li>
<p>host:</p>
<p>docker守护进程管理镜像及运行容器</p>
</li>
<li>
<p>registry:</p>
<p>docker公共镜像库</p>
</li>
</ul>
<h4 id="docker技术组成">docker技术组成</h4>
<p>Images 镜像：</p>
<p>你可以在已经存在的镜像基础上创建自己镜像。创建<code>Dockerfile</code>，它规定了你的镜像基于什么镜像框架、如何创建和运行你的应用。当你对它进行改动时，只有改动的部分会重建，这使得镜像的创建变得轻量、快速。</p>
<p>Containers 容器：</p>
<p>容器是镜像的可运行界面。它的创建及配置基于镜像的配置。它是相对独立的，你可以控制它的网络，储存等。对它的任何改动都将在容器摧毁时被销毁。</p>
<p>这是一个轻松的示例：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker run -i -t ubuntu /bin/bash
</span></span></code></pre></td></tr></table>
</div>
</div><p>上述命令可以启动一个<code>ubuntu</code>容器。<code>ubuntu</code>会从镜像库中获取，然后在本地创建容器。以下是此命令会发生的详细事情。</p>
<ul>
<li>如果你本地没有<code>ubuntu</code>镜像，则会从镜像库中获取，就如同<code>docker pull ubuntu</code>一样</li>
<li>创建容器，就如同<code>docker container create</code>一样</li>
<li>分配一块可读写文件系统给容器，这允许容器操作本地文件系统</li>
<li>创建网络界面，并连接到默认网络，并给容器注册一个ip。</li>
<li>docker运行<code>/bin/bash</code>，这让你通过当前命令行连接到容器中。</li>
<li>当你断开命令行时，docker会停止此容器，但不会删除，你可以选择再次启动或者移除它</li>
</ul>
<h4 id="docker底层技术">docker底层技术</h4>
<p>docker使用golang语言编写，并使用了linux的内核功能。</p>
<p>docker使用了linux的命名空间<code>namespaces</code>。linux内核使用各种命名空间来分离进程树、网络接口、挂载点及进程间的通信资源。这使得容器可以安全并独立的运行。</p>
<p>更多信息查看<a href="https://docs.docker.com/">docker docs</a>。</p>
<h3 id="开始安装">开始安装</h3>
<p>根据<a href="https://docs.docker.com/desktop/windows/install/">官方教程</a>，首先开启虚拟化。</p>
<p>在本文编写时，正是win11正式版刚发布的时间点，本文使用win10来进行配置。</p>
<p>官方给了<code>Hyper-V backend and Windows containers</code>及<code>WSL 2 backend</code>两种运行方式，此处选择第一种。</p>
<p>首先，开启bios里的虚拟化功能，再在win里开启<code>Hyper-V</code>。</p>
<p>找到<code>控制面板\所有控制面板项\程序和功能</code>中的<code>启用或关闭windows功能</code>，找到<code>Hyper-V</code>，勾选并确定，此时将会重启安装。</p>
<p>如一切顺利，接下来下载<a href="https://docs.docker.com/desktop/windows/install/">docker destop</a>。</p>
<p>注意，注册是不需要的，但如果直接访问<code>https://www.docker.com/products/personal</code>则会要求先注册。</p>
<p>点击安装，需要勾选使用<code>Hyper-V backend and Windows containers</code>还是<code>WSL 2 backend</code>，两项中仅选择<code>Hyper-V</code>。</p>
<p>有时也并不会有<code>Hyper-V</code>的选项，不过只要确定<code>Hyper-V</code>已启动，那么不用勾选亦能成功安装启动。</p>
<p>如一切正常，将会重启，然后安装成功。</p>
<p>首次打开<code>docker destop</code>时，会再次提示选择<code>Hyper-V backend and Windows containers</code>还是<code>WSL 2 backend</code>，此时选择<code>Hyper-V</code>。</p>
<p>然后<code>docker</code>就开始启动，如一切正常，则会开始教程使用，但这不是必须的，可以跳过。</p>
<p>接着可以对<code>docker destop</code>进行一些调整，在设置中，可以禁止<code>docker destop</code>的自动启动，调整容器配置，选择切换运行方式。</p>
<p>同npm一样，docker也可使用镜像库，在设置中找到<code>Daemon</code>，在<code>Registry mirrors</code>中添加镜像源。</p>
<p>镜像源：</p>
<ul>
<li><a href="https://docker.mirrors.ustc.edu.cn">https://docker.mirrors.ustc.edu.cn</a></li>
<li><a href="http://hub-mirror.c.163.com">http://hub-mirror.c.163.com</a></li>
</ul>
<p>使用aliyun的镜像加速：</p>
<p>登录<a href="https://cr.console.aliyun.com/">https://cr.console.aliyun.com/</a>，选择镜像工具，即可取得镜像加速器地址</p>
<h3 id="入门使用">入门使用</h3>
<p>本章是一个连续的操作，为了方便，也做了分标题。</p>
<h4 id="创建镜像">创建镜像</h4>
<p>创建镜像需要<code>Dockerfile</code>文件（注意是无后缀名的），下面介绍此文件的结构。</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># syntax=docker/dockerfile:1</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#000;font-weight:bold">FROM</span><span style="color:#d14"> ubuntu:18.04</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#000;font-weight:bold">COPY</span> . /app<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#000;font-weight:bold">RUN</span> make /app<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#000;font-weight:bold">CMD</span> python /app/app.py<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><code># syntax</code>:此功能仅在使用BuildKit后端时可用,在使用经典构建器后端时会被忽略，为了兼容性，你随时应当加上此标签，<a href="https://docs.docker.com/engine/reference/builder/#syntax">更多关于该标签的信息</a></p>
<p><code>FROM</code>:基于哪个镜像（这必须是第一个标签）</p>
<p><code>COPY</code>:添加文件到镜像中</p>
<p><code>RUN</code>:创建镜像时运行的命令</p>
<p><code>CMD</code>:运行镜像时运行的命令</p>
<p>除此之外，常用的还有：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># 指定下面的RUN CMD COPY ADD ENTRYPOINT的工作路径</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#000;font-weight:bold">WORKDIR</span><span style="color:#d14"> /path/to/workdir</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#998;font-style:italic"># 声明镜像暴露的端口，但实际还需要在运行时使用-p等进行映射</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#000;font-weight:bold">EXPOSE</span><span style="color:#d14"> 8080</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#998;font-style:italic"># 环境变量</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#000;font-weight:bold">ENV</span> <span style="color:#008080">MY_CAT</span><span style="color:#000;font-weight:bold">=</span>fluffy
</span></span></code></pre></td></tr></table>
</div>
</div><p>更多标签，见<a href="https://docs.docker.com/engine/reference/builder/">reference</a></p>
<p>下面给一个<code>Dockerfile</code>就可以创建镜像的例子，将它放在一空文件夹下，就可以开始创建镜像了</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">FROM</span><span style="color:#d14"> ubuntu</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#000;font-weight:bold">CMD</span> <span style="color:#0086b3">echo</span> <span style="color:#d14">&#34;This is a test.&#34;</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>当在项目的根创建了此文件后，就可以开始创建镜像了，在此文件夹打开命令行。</p>
<pre tabindex="0"><code>docker build -t test .
</code></pre><p><code>-t</code>后跟一好记的名称，更多关于build的选项，运行<code>docker build --help</code>查看</p>
<pre tabindex="0"><code>PS C:\Users\011474\Downloads\getting-started-master\test&gt; docker build -t test .                             
[+] Building 5.3s (5/5) FINISHED
 =&gt; [internal] load build definition from Dockerfile                                                    0.0s
 =&gt; =&gt; transferring dockerfile: 31B                                                                     0.0s
 =&gt; [internal] load .dockerignore                                                                       0.0s
 =&gt; =&gt; transferring context: 2B                                                                         0.0s
 =&gt; [internal] load metadata for docker.io/library/ubuntu:latest                                        5.2s
 =&gt; CACHED [1/1] FROM docker.io/library/ubuntu@sha256:626ffe58f6e7566e00254b638eb7e0f3b11d4da9675088f4  0.0s
 =&gt; exporting to image                                                                                  0.0s
 =&gt; =&gt; exporting layers                                                                                 0.0s
 =&gt; =&gt; writing image sha256:6b703d5b349b873e3d61b9d8f1b401d36fe0fd3aa8520f8b9357b763a3b9a504            0.0s
 =&gt; =&gt; naming to docker.io/library/test                                                                 0.0s

Use &#39;docker scan&#39; to run Snyk tests against images to find vulnerabilities and learn how to fix them
</code></pre><h4 id="查看镜像">查看镜像</h4>
<p>很快就创建好了镜像，使用下述命令可以看到本地的镜像。更多关于docker本身命令的选项，运行<code>docker --help</code></p>
<pre tabindex="0"><code>PS C:\Users\011474\Downloads\getting-started-master\test&gt; docker images
REPOSITORY   TAG       IMAGE ID       CREATED      SIZE
test         latest    6b703d5b349b   6 days ago   72.8MB
</code></pre><h4 id="运行镜像">运行镜像</h4>
<p>使用下述运行镜像。</p>
<pre tabindex="0"><code>PS C:\Users\011474\Downloads\getting-started-master\test&gt; docker run test
This is a test.
</code></pre><p>在下面的章节将会对<code>run</code>命令进行更多解读，如果想先看它有什么选项，可以运行<code>docker run --help</code></p>
<h4 id="查看容器">查看容器</h4>
<p>在运行了镜像之后，会生成一个容器，使用下述命令查看容器</p>
<pre tabindex="0"><code>docker ps -a
CONTAINER ID   IMAGE     COMMAND                   CREATED         STATUS                     PORTS     NAMES
2e570ad005b5   test      &#34;/bin/sh -c &#39;echo \&#34;T…&#34;   4 minutes ago   Exited (0) 4 minutes ago             magical_gauss
</code></pre><p>如果不加<code>-a</code>，默认是查看当前运行中的容器，更多选项可以运行<code>docker ps --help</code>查看</p>
<h4 id="创建容器">创建容器</h4>
<p>当然，你也可以先创建容器但不运行。关于<code>create</code>的命令，在下面的章节将会对它进行更多解读</p>
<pre tabindex="0"><code>docker create test
9d0138ed77de728dac04cb08b027fed282be6602a07ddfc3b7f07f2d294d2d27
</code></pre><p>返回的是容器的id，当然在使用此id时，并不需要把全部都输入，只需要输入足够位数，可以让docker区分即可</p>
<h4 id="运行容器">运行容器</h4>
<p>运行创建的容器可以使用如下命令。</p>
<pre tabindex="0"><code>docker start -a 9d0138ed77d
This is a test.
</code></pre><p><code>-a</code>可以使我们直接连接到此容器的命令行。<code>-d</code>可以独立的运行（后台运行）。更多选项可以运行<code>docker start --help</code>查看</p>
<h4 id="重启停止容器查看容器占用">重启、停止容器，查看容器占用</h4>
<p>停止运行中的容器可以使用<code>docker stop 此处为容器id</code>，也支持延时关闭，具体运行<code>docker stop --help</code>查看。</p>
<p>如果无法停止，可以使用<code>docker kill 此处为容器id</code>强制停止，支持发送指定信号，具体运行<code>docker kill --help</code>查看。</p>
<p>同样，重启容器与停止命令相似，更多选项运行<code>docker restart --help</code>查看</p>
<p>使用如下指令可以实时查看各容器对硬件资源的占用情况</p>
<pre tabindex="0"><code>docker stats
CONTAINER ID   NAME      CPU %     MEM USAGE / LIMIT   MEM %     NET I/O   BLOCK I/O   PIDS
</code></pre><h4 id="删除容器">删除容器</h4>
<p>在有容器绑定镜像时，镜像是默认不能删除的，所以先删除容器。rm后跟容器id</p>
<pre tabindex="0"><code>docker rm 2e570ad005b5
2e570ad005b5
</code></pre><p>当然你可以加上<code>-f</code>来强行终止容器，加上<code>-v</code>来顺便移除容器使用的本地文件系统。更多选项可以运行<code>docker rm --help</code>查看</p>
<h4 id="删除镜像">删除镜像</h4>
<p>然后即可删除镜像，更多选项可以运行<code>docker rmi --help</code>查看</p>
<pre tabindex="0"><code>docker rmi test
Untagged: test:latest
Deleted: sha256:00d9dc028d3adc93e997e4c87b168426ee55cb58f6b71c233741c274b88404bc
</code></pre><p>还记得之前用<code>create</code>创建的容器么，在项目目录中，我们找不到此容器的具体文件。如果我们想对其进行分发，就有以下几种方法。</p>
<h4 id="分发镜像">分发镜像</h4>
<p>运行下面的命令可以创建一个本地包</p>
<pre tabindex="0"><code>docker save test -o a.tar
</code></pre><p>这会在当前文件夹生成a.tar，而这个tar包可以拷贝到其他地方进行导入</p>
<p>此处先删除<code>test</code>镜像后，运行下述命令即可导入。</p>
<pre tabindex="0"><code>docker load -i .\a.tar
Loaded image: test:latest
</code></pre><p>另外，我们还可以推送到docker镜像库中</p>
<h4 id="创建挂载删除查找持久卷">创建、挂载、删除、查找持久卷</h4>
<p>上面提到，删除容器时，可以同时删除容器的本地文件系统，此处我们对如何持久化数据进行讲解。</p>
<p>首先创建容器卷</p>
<pre tabindex="0"><code>docker volume create test
test
</code></pre><p>在启动容器时，使用<code>-v 容器卷名称:挂载路径</code>选项，然后此容器将会挂载此容器卷。</p>
<p>你可以查看此卷的详细位置<code>Mountpoint</code></p>
<pre tabindex="0"><code>docker volume inspect test
[
    {
        &#34;CreatedAt&#34;: &#34;2021-10-25T05:42:43Z&#34;,
        &#34;Driver&#34;: &#34;local&#34;,
        &#34;Labels&#34;: {},
        &#34;Mountpoint&#34;: &#34;/var/lib/docker/volumes/test/_data&#34;,
        &#34;Name&#34;: &#34;test&#34;,
        &#34;Options&#34;: {},
        &#34;Scope&#34;: &#34;local&#34;
    }
]
</code></pre><p>注意，在windows上时，此卷是存储在hyper-V虚拟机中的，因此你并不能在资源管理器中找到这个卷。</p>
<p>如果你在Linux上运行docker，那就可以在如上路径找到此容器卷。</p>
<p>删除容器卷使用如下命令</p>
<pre tabindex="0"><code>docker volume rm test
test
</code></pre><p>请注意，如果你只需要让多个容器可以挂载同一个文件系统时，你并不需要创建持久卷。看下面的多个应用容器，里面会提到如何解决这个情况。</p>
<h4 id="连接到容器">连接到容器</h4>
<p>有时我们需要进入容器运行命令。当我们在启动容器时就打开命令行连接时：</p>
<pre tabindex="0"><code>docker run -it ubuntu
root@9d5c8c100540:/# ls
bin  boot  dev  etc  home  lib  lib32  lib64  libx32  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var
</code></pre><p>这会在容器启动后直接连接到容器的命令行，使用<code>ctrl+p+q</code>在保持容器运行的情况下退出命令行。若使用<code>exit</code>退出，容器将同时停止。</p>
<p>在已经启动容器的情况下，使用如下命令连接到容器</p>
<pre tabindex="0"><code>docker attach 容器id
</code></pre><p>有时，你只想让容器执行某条命令而不想进入容器</p>
<pre tabindex="0"><code>docker exec 容器id 命令
</code></pre><p>如果在使用<code>exec</code>时，想对工作路径等做出要求，可以使用<code>-w</code>选项，更多运行<code>docker exec --help</code>查看</p>
<h4 id="使用启动文件">使用启动文件</h4>
<p>在启动容器时，可以使用<a href="https://docs.docker.com/compose/compose-file/">配置文件</a>进行启动，从而省去繁杂的命令行选项。通过配置文件启动，可以同时配置并启动多个容器。</p>
<p>此处先给出一示例：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">96
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span><span style="color:#000080">version</span>:<span style="color:#bbb"> </span><span style="color:#d14">&#34;3.9&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000080">services</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">redis</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">image</span>:<span style="color:#bbb"> </span>redis:alpine<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">ports</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>- <span style="color:#d14">&#34;6379&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">networks</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>- frontend<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">deploy</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#000080">replicas</span>:<span style="color:#bbb"> </span><span style="color:#099">2</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#000080">update_config</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#000080">parallelism</span>:<span style="color:#bbb"> </span><span style="color:#099">2</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#000080">delay</span>:<span style="color:#bbb"> </span>10s<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#000080">restart_policy</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#000080">condition</span>:<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">on</span>-failure<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">db</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">image</span>:<span style="color:#bbb"> </span>postgres:9.4<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">volumes</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>- db-data:/var/lib/postgresql/data<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">networks</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>- backend<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">deploy</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#000080">placement</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#000080">max_replicas_per_node</span>:<span style="color:#bbb"> </span><span style="color:#099">1</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#000080">constraints</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">          </span>- <span style="color:#d14">&#34;node.role==manager&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">vote</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">image</span>:<span style="color:#bbb"> </span>dockersamples/examplevotingapp_vote:before<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">ports</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>- <span style="color:#d14">&#34;5000:80&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">networks</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>- frontend<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">depends_on</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>- redis<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">deploy</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#000080">replicas</span>:<span style="color:#bbb"> </span><span style="color:#099">2</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#000080">update_config</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#000080">parallelism</span>:<span style="color:#bbb"> </span><span style="color:#099">2</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#000080">restart_policy</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#000080">condition</span>:<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">on</span>-failure<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">result</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">image</span>:<span style="color:#bbb"> </span>dockersamples/examplevotingapp_result:before<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">ports</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>- <span style="color:#d14">&#34;5001:80&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">networks</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>- backend<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">depends_on</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>- db<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">deploy</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#000080">replicas</span>:<span style="color:#bbb"> </span><span style="color:#099">1</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#000080">update_config</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#000080">parallelism</span>:<span style="color:#bbb"> </span><span style="color:#099">2</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#000080">delay</span>:<span style="color:#bbb"> </span>10s<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#000080">restart_policy</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#000080">condition</span>:<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">on</span>-failure<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">worker</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">image</span>:<span style="color:#bbb"> </span>dockersamples/examplevotingapp_worker<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">networks</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>- frontend<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>- backend<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">deploy</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#000080">mode</span>:<span style="color:#bbb"> </span>replicated<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#000080">replicas</span>:<span style="color:#bbb"> </span><span style="color:#099">1</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#000080">labels</span>:<span style="color:#bbb"> </span>[APP=VOTING]<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#000080">restart_policy</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#000080">condition</span>:<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">on</span>-failure<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#000080">delay</span>:<span style="color:#bbb"> </span>10s<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#000080">max_attempts</span>:<span style="color:#bbb"> </span><span style="color:#099">3</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#000080">window</span>:<span style="color:#bbb"> </span>120s<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#000080">placement</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#000080">constraints</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">          </span>- <span style="color:#d14">&#34;node.role==manager&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">visualizer</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">image</span>:<span style="color:#bbb"> </span>dockersamples/visualizer:stable<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">ports</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>- <span style="color:#d14">&#34;8080:8080&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">stop_grace_period</span>:<span style="color:#bbb"> </span>1m30s<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">volumes</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>- <span style="color:#d14">&#34;/var/run/docker.sock:/var/run/docker.sock&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">deploy</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#000080">placement</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#000080">constraints</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">          </span>- <span style="color:#d14">&#34;node.role==manager&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000080">networks</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">frontend</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">backend</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000080">volumes</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">db-data</span>:<span style="color:#bbb">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>这个配置文件用到了一些常用的标签：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># 执行命令</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000080">command</span>:<span style="color:#bbb"> </span>bundle exec thin -p 3000<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#998;font-style:italic"># 容器名称</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000080">container_name</span>:<span style="color:#bbb"> </span>my-web-container<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#998;font-style:italic"># 依赖depends_on</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000080">version</span>:<span style="color:#bbb"> </span><span style="color:#d14">&#34;3.9&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000080">services</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">web</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">build</span>:<span style="color:#bbb"> </span>.<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">depends_on</span>:<span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>- db<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>- redis<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">redis</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">image</span>:<span style="color:#bbb"> </span>redis<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">db</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">image</span>:<span style="color:#bbb"> </span>postgres<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#998;font-style:italic"># 模式mode  global(一节点一容器)  replicated</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000080">version</span>:<span style="color:#bbb"> </span><span style="color:#d14">&#34;3.9&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000080">services</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">worker</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">image</span>:<span style="color:#bbb"> </span>dockersamples/examplevotingapp_worker<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">deploy</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#000080">mode</span>:<span style="color:#bbb"> </span>global  <span style="color:#bbb">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="多个应用容器">多个应用容器</h3>
<p>通常，一个容器只把一样事情做好。原因有以下几点：</p>
<ul>
<li>不同的技术层进行分离</li>
<li>不同的容器可以分别管理版本</li>
<li>自定义的本地化开发环境容器组件</li>
<li>一个容器只能在一个进程中运行，而多应用一容器或需要进程管理器</li>
</ul>
<p>以上解释了为什么我们需要多个容器，下面将举一个例子，说明多容器之间如何进行文件、网络的互通。</p>
<h4 id="docker网络环境">docker网络环境</h4>
<p>创建一个docker网络环境，并给每个容器一个名称，其他同网络的容器将可以通过此名称连接到对应容器。其实现原理大致是<code>dns</code>。</p>
<pre tabindex="0"><code>docker network create todo-app
123d8571d6c9b5aae62d4724318c49188e53e6f6b4eb533f11fa38b44238f0f0
</code></pre><p>返回的是网络id，通常记住<code>todo-app</code>这个名称即可</p>
<p>我们可以通过如下命令查看docker网络</p>
<pre tabindex="0"><code>docker network ls
NETWORK ID     NAME       DRIVER    SCOPE
93287fac1141   bridge     bridge    local
30a4f33bd1e4   host       host      local
c49488f43723   none       null      local
123d8571d6c9   todo-app   bridge    local
</code></pre><p>其中，<code>host</code>,<code>bridge</code>,<code>null</code>是默认的。更多关于如何管理网络的命令，运行<code>docker network --help</code>查看</p>
<h4 id="docker多容器共享卷">docker多容器共享卷</h4>
<p>在启动不同容器，通过<code>-v 容器卷名称:挂载路径</code>选项挂载卷时，只要卷的名称相同，那么不同容器即可挂载同一个卷。这个卷若无将会自动创建。</p>
<h4 id="新建mysql容器">新建Mysql容器</h4>
<p>通过下述命令，你可以很容易的创建一个mysql服务。注意下述命令在PowerShell中使用，在命令行请考虑更改/去掉换行符<!-- raw HTML omitted -->`<!-- raw HTML omitted --></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>docker run -d `
</span></span><span style="display:flex;"><span>--network <span style="color:#0086b3">todo-app</span> --network-alias mysql `
</span></span><span style="display:flex;"><span>-v <span style="color:#0086b3">todo-mysql</span>-data:/var/lib/mysql `
</span></span><span style="display:flex;"><span>-e MYSQL_ROOT_PASSWORD=secret `
</span></span><span style="display:flex;"><span>-e MYSQL_DATABASE=todos `
</span></span><span style="display:flex;"><span>mysql<span style="color:#a61717;background-color:#e3d2d2">:</span><span style="color:#099">5.7</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="新建ubuntu容器">新建ubuntu容器</h4>
<p>也可以<a href="">使用netshoot容器</a>来进行网络测试，但此处我就使用<code>ubuntu</code>来测试了。</p>
<pre tabindex="0"><code>docker run -it --network todo-app --network-alias u ubuntu
</code></pre><p>这样，这个ubuntu容器就运行在与上述mysql同一网络环境中了</p>
<p>首先安装一下基本包及<code>aptitude</code>，然后安装<code>mysql</code>客户端。</p>
<pre tabindex="0"><code>apt-get update
apt-get install aptitude
aptitude install mysql-client
</code></pre><p>一切准备完毕后，输入命令及密码<code>secret</code></p>
<pre tabindex="0"><code>mysql -h mysql -u root -p
Enter password:
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 4
Server version: 5.7.36 MySQL Community Server (GPL)

Copyright (c) 2000, 2021, Oracle and/or its affiliates.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type &#39;help;&#39; or &#39;\h&#39; for help. Type &#39;\c&#39; to clear the current input statement.

mysql&gt; exit
Bye
</code></pre><p>一切工作良好。</p>
<h3 id="常用的镜像">常用的镜像</h3>
<p><a href="https://hub.docker.com/search?type=image">公用镜像库</a>提供了许多官方/第三方的镜像，下面举几个常见的镜像。</p>
<h4 id="java">JAVA</h4>
<p><a href="https://hub.docker.com/_/openjdk?tab=tags">openjdk</a></p>
<p>可以直接在<code>FROM</code>中，下面提供一个完整<code>Dockeerfile</code>示例</p>
<pre tabindex="0"><code># syntax=docker/dockerfile:1

FROM openjdk:16-alpine3.13

WORKDIR /app

COPY .mvn/ .mvn
COPY mvnw pom.xml ./
RUN ./mvnw dependency:go-offline

COPY src ./src

CMD [&#34;./mvnw&#34;, &#34;spring-boot:run&#34;]
</code></pre><h4 id="go">GO</h4>
<p><a href="https://hub.docker.com/_/golang">golang</a></p>
<pre tabindex="0"><code># syntax=docker/dockerfile:1

FROM golang:1.16-alpine

WORKDIR /app

COPY go.mod ./
COPY go.sum ./
RUN go mod download

COPY *.go ./

RUN go build -o /docker-gs-ping

EXPOSE 8080

CMD [ &#34;/docker-gs-ping&#34; ]
</code></pre><h3 id="关于容器的其他注意事项">关于容器的其他注意事项</h3>
<h4 id="配置debian类容器时区">配置debian类容器时区</h4>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>apt-get install tzdata
</span></span><span style="display:flex;"><span>tzselect
</span></span><span style="display:flex;"><span>cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime
</span></span></code></pre></td></tr></table>
</div>
</div>
        </div>

        
<div class="post-archive">
    <ul class="post-copyright">
        <li><strong>原文作者：</strong><a rel="author" href="/">qydysky</a></li>
        <li style="word-break:break-all"><strong>原文链接：</strong><a href="/post/20211021docker/">/post/20211021docker/</a></li>
        <li><strong>版权声明：</strong>本作品采用<a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/">知识共享署名-非商业性使用-禁止演绎 4.0 国际许可协议</a>进行许可，非商业转载请注明出处（作者，原文链接），商业转载请联系作者获得授权。</li>
    </ul>
</div>
<br/>



        

<div class="post-archive">
    <h2 class="related-title">更多</h2>
    <ul class="listing">
        
        <li><a href="/post/20211017canvas2byte/">一次水墨屏的js画布数据处理发送</a></li>
        
        <li><a href="/post/20211015error/">常见错误总结</a></li>
        
        <li><a href="/post/20211012spring/">Spring注释配置</a></li>
        
        <li><a href="/post/20211006vueElementAdmin/">vueElementAdmin配置</a></li>
        
        <li><a href="/post/20211004database/">mysql、oracle备忘记录</a></li>
        
    </ul>
</div>


    </article>
    
    

    
    
</div>

                    <footer id="footer">
    <div>
        &copy; 2024 <a href="/">qydysky&#39;s blog By qydysky</a>
        
    </div>
    <br />
    <div>
        <a href="https://icp.gov.moe/?keyword=20240909" target="_blank">萌ICP备20240909号</a>
    </div>
    <br />
    <div>
        <div class="github-badge">
            <a href="https://gohugo.io/" target="_black" rel="nofollow"><span class="badge-subject">Powered by</span><span class="badge-value bg-blue">Hugo</span></a>
        </div>
        <div class="github-badge">
            <a href="https://github.com/flysnow-org/maupassant-hugo" target="_black"><span class="badge-subject">Theme</span><span class="badge-value bg-yellowgreen">Maupassant</span></a>
        </div>
    </div>
</footer>


    
    <script type="text/javascript">
        window.MathJax = {
            tex2jax: {
                inlineMath: [['$', '$']],
                processEscapes: true
                }
            };
    </script>
    <script src='/js/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>

<a id="rocket" href="#top"></a>
<script type="text/javascript" src='/js/totop.js?v=0.0.0' async=""></script>






                </div>

                <div id="secondary">
    <section class="widget">
        <form id="search" action='/search/' method="get" accept-charset="utf-8" target="_blank" _lpchecked="1">
      
      <input type="text" name="q" maxlength="20" placeholder="Search">
      <input type="hidden" name="sitesearch" value="/">
      <button type="submit" class="submit icon-search"></button>
</form>
    </section>
    
    

    <section class="widget">
        <h3 class="widget-title"><a href='/tags/'>标签</a></h3>
<div class="tagcloud">
    
    <a href="/tags/Caddy/">Caddy</a>
    
    <a href="/tags/amixer/">amixer</a>
    
    <a href="/tags/ap/">ap</a>
    
    <a href="/tags/aria2/">aria2</a>
    
    <a href="/tags/c/">c</a>
    
    <a href="/tags/canvas/">canvas</a>
    
    <a href="/tags/certbot/">certbot</a>
    
    <a href="/tags/crontab/">crontab</a>
    
    <a href="/tags/docker/">docker</a>
    
    <a href="/tags/ffmpeg/">ffmpeg</a>
    
    <a href="/tags/flv/">flv</a>
    
    <a href="/tags/fmp4/">fmp4</a>
    
    <a href="/tags/frp/">frp</a>
    
    <a href="/tags/gateway/">gateway</a>
    
    <a href="/tags/golang/">golang</a>
    
    <a href="/tags/hexo/">hexo</a>
    
    <a href="/tags/javascript/">javascript</a>
    
    <a href="/tags/kde/">kde</a>
    
    <a href="/tags/kioexec/">kioexec</a>
    
    <a href="/tags/l4d2/">l4d2</a>
    
    <a href="/tags/legado/">legado</a>
    
    <a href="/tags/letsencrypt/">letsencrypt</a>
    
    <a href="/tags/linux/">linux</a>
    
    <a href="/tags/mock/">mock</a>
    
    <a href="/tags/mp4/">mp4</a>
    
    <a href="/tags/mysql/">mysql</a>
    
    <a href="/tags/nas/">nas</a>
    
    <a href="/tags/ncurses/">ncurses</a>
    
    <a href="/tags/nodejs/">nodejs</a>
    
    <a href="/tags/nvm/">nvm</a>
    
    <a href="/tags/openwrt/">openwrt</a>
    
    <a href="/tags/oracle/">oracle</a>
    
    <a href="/tags/plugin/">plugin</a>
    
    <a href="/tags/pocketbase/">pocketbase</a>
    
    <a href="/tags/regExp/">regExp</a>
    
    <a href="/tags/sh/">sh</a>
    
    <a href="/tags/shell/">shell</a>
    
    <a href="/tags/snap/">snap</a>
    
    <a href="/tags/sourcemod/">sourcemod</a>
    
    <a href="/tags/spring/">spring</a>
    
    <a href="/tags/truenas/">truenas</a>
    
    <a href="/tags/url/">url</a>
    
    <a href="/tags/vs/">vs</a>
    
    <a href="/tags/vue-element-admin/">vue-element-admin</a>
    
    <a href="/tags/wifi7/">wifi7</a>
    
    <a href="/tags/xiaomi/">xiaomi</a>
    
    <a href="/tags/%E6%97%A5%E5%B8%B8/">日常</a>
    
</div>
    </section>

    
<section class="widget">
    <h3 class="widget-title">友情链接</h3>
    <ul class="widget-list">
        
        <li>
            <a target="_blank" href="https://vcb-s.com/" title="VCB-Studio">VCB-Studio</a>
        </li>
        
    </ul>
</section>


    <section class="widget">
        <h3 class="widget-title">其它</h3>
        <ul class="widget-list">
            <li><a href="/index.xml">文章 RSS</a></li>
        </ul>
    </section>

    <style type="text/css">
    .post-toc {
        max-width: 100%;
        max-height: 80%;
        font-family: Athelas, STHeiti, Microsoft Yahei, serif;
        font-size: 12px;
        word-wrap: break-word;
        white-space: nowrap;
        z-index: 999;
        cursor: pointer;
    }

    .post-toc .post-toc-title {
        color: #6E7173;
        line-height: 2.7;
        margin-top: 0;
        font-size: 16px;
        border-bottom: 1px solid #ddd;
        display: block;
    }

    .post-toc .post-toc-content {
        font-size: 15px;
    }

    .post-toc .post-toc-content>nav>ul {
        margin: 10px 0;
        margin-block: 0.5rem;
        padding-inline: 0.1rem;
    }

    .post-toc .post-toc-content ul {
        list-style: none;
        line-height: 1.8em;
    }

    .post-toc .post-toc-content ul ul {
        padding-left: 15px;
        font-size: 0.8rem;
    }

    @media print,
    screen and (max-width:1057px) {
        .post-toc {
            display: none;
        }
    }
</style>
<div class="post-toc">
    <h2 class="post-toc-title">目录</h2>
    <div class="post-toc-content">
        <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#docker学习笔记">docker学习笔记</a>
          <ul>
            <li><a href="#基础概念">基础概念</a>
              <ul>
                <li><a href="#最初印象">最初印象</a></li>
                <li><a href="#docker组织组成">docker组织组成</a></li>
                <li><a href="#docker技术组成">docker技术组成</a></li>
                <li><a href="#docker底层技术">docker底层技术</a></li>
              </ul>
            </li>
            <li><a href="#开始安装">开始安装</a></li>
            <li><a href="#入门使用">入门使用</a>
              <ul>
                <li><a href="#创建镜像">创建镜像</a></li>
                <li><a href="#查看镜像">查看镜像</a></li>
                <li><a href="#运行镜像">运行镜像</a></li>
                <li><a href="#查看容器">查看容器</a></li>
                <li><a href="#创建容器">创建容器</a></li>
                <li><a href="#运行容器">运行容器</a></li>
                <li><a href="#重启停止容器查看容器占用">重启、停止容器，查看容器占用</a></li>
                <li><a href="#删除容器">删除容器</a></li>
                <li><a href="#删除镜像">删除镜像</a></li>
                <li><a href="#分发镜像">分发镜像</a></li>
                <li><a href="#创建挂载删除查找持久卷">创建、挂载、删除、查找持久卷</a></li>
                <li><a href="#连接到容器">连接到容器</a></li>
                <li><a href="#使用启动文件">使用启动文件</a></li>
              </ul>
            </li>
            <li><a href="#多个应用容器">多个应用容器</a>
              <ul>
                <li><a href="#docker网络环境">docker网络环境</a></li>
                <li><a href="#docker多容器共享卷">docker多容器共享卷</a></li>
                <li><a href="#新建mysql容器">新建Mysql容器</a></li>
                <li><a href="#新建ubuntu容器">新建ubuntu容器</a></li>
              </ul>
            </li>
            <li><a href="#常用的镜像">常用的镜像</a>
              <ul>
                <li><a href="#java">JAVA</a></li>
                <li><a href="#go">GO</a></li>
              </ul>
            </li>
            <li><a href="#关于容器的其他注意事项">关于容器的其他注意事项</a>
              <ul>
                <li><a href="#配置debian类容器时区">配置debian类容器时区</a></li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>
<script type="text/javascript">
    $(document).ready(function () {
        var postToc = $(".post-toc");
        if (postToc.length) {

            var t = postToc.offset().top - 20,
                a = {
                    start: {
                        position: "unset",
                        top: "unset",
                        overflow: "unset",
                        paddingRight: "unset"
                    },
                    process: {
                        position: "fixed",
                        top: 20,
                        overflow: "hidden auto",
                        paddingRight: "5em"
                    },
                };

            var e = $(window).scrollTop();
            e < t ? postToc.css(a.start) : postToc.css(a.process)

            $(window).scroll(function () {
                var e = $(window).scrollTop();
                e < t ? postToc.css(a.start) : postToc.css(a.process)
            })
        }
    })
</script>
    
</div>
            </div>
        </div>
    </div>
</body>

</html>